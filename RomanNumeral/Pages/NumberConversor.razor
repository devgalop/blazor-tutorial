@page "/Conversor"

<h3>Conversor:</h3>

<div class="mb-3">
    <select class="form-select" name="conversionType" @bind="_conversionTypeSelected">
        <option value="0">Select a conversion type</option>
        @foreach(var conversionType in _conversionTypes)
        {
            <option value="@conversionType.Id">@conversionType.Title</option>
        }
    </select>
</div>

<div class="mb-3">
    <h4>Conversion type selected : @_conversionTypeSelected</h4>
    @if(_conversionTypeSelected == 1)
    {
        <div class="">
            <label for="">Number:</label>
            <input type="text" placeholder="Write a number" @bind="_naturalRequest.Number">
            <button class="btn btn-primary" @onclick="ConvertFromNaturalToRoman">Convert</button>
        </div>
        @if(!string.IsNullOrEmpty(_naturalResponse.RomanNumberConverted))
        {
            <div class="" style="padding-top: 20px">
                <h4 class="alert alert-primary">The number @_naturalRequest.Number converted to roman number is: @_naturalResponse.RomanNumberConverted</h4>
            </div>
        }
    }else if(_conversionTypeSelected == 2)
    {
        <p>Se ha seleccionado la 2</p>
    }
</div>



@code {
    private List<ConversionType> _conversionTypes = new();
    private int _conversionTypeSelected;
    private RomanRequest _romanRequest = new();
    private NaturalRequest _naturalRequest = new();
    private RomanResponse _romanRespone = new();
    private NaturalResponse _naturalResponse = new();

    protected override void OnInitialized()
    {
        base.OnInitialized();
        _conversionTypes = new List<ConversionType>()
        {
            new ConversionType()
            {
                Id = 1,
                Title = "From Natural to Roman"
            },
            new ConversionType()
            {
                Id = 2,
                Title = "From Roman to Natural"
            }
        };
    }

    private void ConvertFromNaturalToRoman()
    {
        _naturalResponse.RomanNumberConverted = GetRomanNumber(_naturalRequest.Number);
    }

    private string GetRomanNumber(int number)
    {
        if ((number < 0) || (number > 3999)) throw new ArgumentOutOfRangeException("insert value betwheen 1 and 3999");
        if (number < 1) return string.Empty;            
        if (number >= 1000) return "M" + GetRomanNumber(number - 1000);
        if (number >= 900) return "CM" + GetRomanNumber(number - 900); 
        if (number >= 500) return "D" + GetRomanNumber(number - 500);
        if (number >= 400) return "CD" + GetRomanNumber(number - 400);
        if (number >= 100) return "C" + GetRomanNumber(number - 100);            
        if (number >= 90) return "XC" + GetRomanNumber(number - 90);
        if (number >= 50) return "L" + GetRomanNumber(number - 50);
        if (number >= 40) return "XL" + GetRomanNumber(number - 40);
        if (number >= 10) return "X" + GetRomanNumber(number - 10);
        if (number >= 9) return "IX" + GetRomanNumber(number - 9);
        if (number >= 5) return "V" + GetRomanNumber(number - 5);
        if (number >= 4) return "IV" + GetRomanNumber(number - 4);
        if (number >= 1) return "I" + GetRomanNumber(number - 1);
        throw new ArgumentOutOfRangeException("something bad happened");
    }

}
